$(function() {
  var root = "<%= Discourse.base_url %>"
	$(".full-calendar").each(function() {
		var url = $(this).attr("data-calendar-url")
		$(this).fullCalendar(
		{
			events: url, 
			titleFormat: {
				month: "MMMM"
			},
      dayNames: ['Sunnuntai', 'Maanantai', 'Tiistai', 'Keskiviikko',
 'Torstai', 'Perjantai', 'Lauantai'],
      dayNamesShort: ['Su', 'Ma', 'Ti', 'Ke', 'To', 'Pe', 'La'],
      monthNames: ['tammikuu', 'helmikuu', 'maaliskuu', 'huhtikuu', 'toukokuu', 'kesäkuu', 'heinäkuu',
 'elokuu', 'syyskuu', 'lokakuu', 'marraskuu', 'joulukuu'],
      timeFormat: '',
      firstDay: 1,
      eventRender: function(event, element) {
        var url = event.description;
        if(!url) return;
        $(element).first("a").attr("href", url)
      },
      dayRender: function(date, cell) { 
        var formattedDate = date.getDate() + "." + date.getMonth() + "." + date.getFullYear();
        <% if @loggedIn %>
        var href = root + '/create_event/' + formattedDate;
        <% else %>
        var href = root + '/signup/';
        <% end %>

        var a = $("<a/>", { href: root + '/create_event/' + formattedDate })
          .append($('<i class="font-icon-plus-sign"/>'))
        var create_event = $('<div class="fc-create-event"/>').append(a);

        $(cell).find(".fc-day-number").before(create_event);
        return cell;
      },
      buttonText: {
        prev:     '&lsaquo;', // <
        next:     '&rsaquo;', // >
        prevYear: '&laquo;',  // <<
        nextYear: '&raquo;',  // >>
        today:    'tänään',
        month:    'kuukausi',
        week:     'viikko',
        day:      'päivä'
      }
		});
	})
});